<!DOCTYPE html>
<html lang="en-US">
  <head>
    <!-- General meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>一致性校验 – Desnowy – Normal people from Zhai</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="分布式系统数据数据一致性

" />
    <meta property="og:description" content="分布式系统数据数据一致性

" />
    
    <meta name="author" content="Desnowy" />

    
    <meta property="og:title" content="一致性校验" />
    <meta property="twitter:title" content="一致性校验" />
    
    
  
    <link rel="icon" type="image/png" href="/assets/logo@16px.png" sizes="16x16">
    <link rel="apple-touch-icon" sizes="16x16" href="/assets/logo@16px.png">
  
    <link rel="icon" type="image/png" href="/assets/logo@32px.png" sizes="32x32">
    <link rel="apple-touch-icon" sizes="32x32" href="/assets/logo@32px.png">
  
    <link rel="icon" type="image/png" href="/assets/logo@96px.png" sizes="96x96">
    <link rel="apple-touch-icon" sizes="96x96" href="/assets/logo@96px.png">
  
    <link rel="icon" type="image/png" href="/assets/logo@120px.png" sizes="120x120">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/logo@120px.png">
  
    <link rel="icon" type="image/png" href="/assets/logo@144px.png" sizes="144x144">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/logo@144px.png">
  
    <link rel="icon" type="image/png" href="/assets/logo@180px.png" sizes="180x180">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/logo@180px.png">
  
    <link rel="icon" type="image/png" href="/assets/logo@512px.png" sizes="512x512">
    <link rel="apple-touch-icon" sizes="512x512" href="/assets/logo@512px.png">
  
    <link rel="icon" type="image/png" href="/assets/logo@1024px.png" sizes="1024x1024">
    <link rel="apple-touch-icon" sizes="1024x1024" href="/assets/logo@1024px.png">
  

<link rel="shortcut icon" href="">


    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Desnowy - Normal people from Zhai" href="/feed.xml" />
    <link rel="manifest" href="/manifest.json">

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="/assets/logo@1024px.png" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Desnowy</a></h1>
            <p class="site-description">Normal people from Zhai</p>
          </div>

          <nav>
            <a href="/">Blog</a>
            <a href="/categories">Categories</a>
            <a href="/search">Search</a>
            <a href="/about">About</a>
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <main class="main  container">
  
  <div class="toc">
    <h2>Table of Contents</h2>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#业务侧系统保证最终一致性">业务侧系统保证最终一致性</a>
<ul>
<li class="toc-entry toc-h3"><a href="#核心思想">核心思想</a></li>
<li class="toc-entry toc-h3"><a href="#设计原则">设计原则</a></li>
<li class="toc-entry toc-h3"><a href="#流程图">流程图</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#平台侧系统保证最终一致性">平台侧系统保证最终一致性</a>
<ul>
<li class="toc-entry toc-h3"><a href="#核心思想-1">核心思想</a></li>
<li class="toc-entry toc-h3"><a href="#设计的基本原则">设计的基本原则</a></li>
<li class="toc-entry toc-h3"><a href="#流程图-1">流程图</a></li>
</ul>
</li>
</ul>
  </div>      
  
  <article class="post">
    <h1>一致性校验</h1>
    

<small class="small  post-meta">
  
  
    
      <span class="label  label--category"><a href="/categories/#application">Application</a></span>
    
  &nbsp;&middot;&nbsp;<time datetime="2023-06-06T00:00:00+00:00" class="time">06 Jun 2023</time>
</small>

    
    <div class="entry">
      <p>分布式系统数据数据一致性</p>

<h2 id="业务侧系统保证最终一致性">业务侧系统保证最终一致性</h2>

<h3 id="核心思想">核心思想</h3>

<p>通过业务系统的服务保证数据的最终一致性，业务系统侧系统记录每一次具体业务操作的执行流水日志信息，并且对没有全部成功的变更结果，触发执行数据一致性的校验核对。</p>

<h3 id="设计原则">设计原则</h3>

<ol>
  <li>根据业务操作标识和业务操作唯一ID实现接口的幂等设计</li>
  <li>实时的同步检查核对、准实时的异步检查核对、定时任务的异步检查核对</li>
</ol>

<h3 id="流程图">流程图</h3>

<ol>
  <li>
    <p>同步执行
<img src="/assets/images/2023-06/业务侧-同步.png" alt="" /></p>
  </li>
  <li>
    <p>异步核对
<img src="/assets/images/2023-06/业务侧-异步.png" alt="" /></p>
  </li>
</ol>

<h2 id="平台侧系统保证最终一致性">平台侧系统保证最终一致性</h2>

<h3 id="核心思想-1">核心思想</h3>

<p>平台侧系统的每一次数据变更，主动寻找业务侧系统，确认本次数据变更结果</p>

<h3 id="设计的基本原则">设计的基本原则</h3>

<ol>
  <li>根据业务操作标识和唯一ID做幂等设计</li>
</ol>

<h3 id="流程图-1">流程图</h3>

<ol>
  <li>
    <p>同步核对
<img src="/assets/images/2023-06/平台侧-同步.png" alt="" /></p>
  </li>
  <li>
    <p>异步核对
<img src="/assets/images/2023-06/平台侧-异步.png" alt="" /></p>
  </li>
</ol>

    </div>
  
    <div class="date">
      Written on June  6, 2023
    </div>
  
    
<div class="comments">
	<!-- <div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'sakaman';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script> -->

	<div id="gisqus_thread"></div>
	<script src="https://giscus.app/client.js" data-repo="sakaman/sakaman.github.io" data-repo-id="R_kgDOHMUjFQ"
    data-category="General" data-category-id="DIC_kwDOHMUjFc4CPANy" data-mapping="pathname" data-reactions-enabled="1"
    data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="zh-CN" data-loading="lazy"
    crossorigin="anonymous" async>
    </script>
	<!-- <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> -->
	<noscript>Please enable JavaScript to view the <a href="http://gisqus.com/?ref_noscript">comments powered by Gisqus.</a></noscript>
</div>

  </article>

</main>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/sakaman/sakaman.github.io"><i class="svg-icon github"></i></a>








          <script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js')
        })
    }
</script>
        </footer>
      </div>
    </div>

    

  </body>
</html>
